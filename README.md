# Руководство пользователя ФитоДомик

## Содержание
1. [Обзор проекта](#обзор-проекта)
2. [Структура проекта](#структура-проекта)
3. [Приложение FitoDomikLo](#приложение-fitodomiklo)
4. [Программа для Arduino](#программа-для-arduino)
5. [Подключение и настройка](#подключение-и-настройка)
6. [Работа с системой](#работа-с-системой)

## Обзор проекта

ФитоДомик - это комплексная система для автоматизации ухода за растениями, состоящая из программного и аппаратного обеспечения. Система позволяет:

- Контролировать температуру и влажность воздуха
- Отслеживать влажность почвы
- Управлять световым режимом (включение/выключение лампы)
- Автоматизировать открытие/закрытие штор
- Анализировать состояние растений по фото
- Вести журнал показаний датчиков и событий

## Структура проекта

Папка `python_application_3_LO` содержит следующие компоненты:

- **FitoDomikLo.py** - основное приложение Python с графическим интерфейсом
- **FitoDomikLo.exe** - скомпилированная версия приложения
- **67fb70c98d5b2.ico** - иконка для приложения
- **temp_humidity_light_2/** - папка со скетчем для Arduino

## Приложение FitoDomikLo

### Основные функции

**FitoDomikLo.py** - это графическое приложение на Python (PyQt6), которое предоставляет интерфейс для взаимодействия с аппаратной частью системы и визуализации данных.

#### Функции GUI-интерфейса:

1. **Мониторинг** - отображение текущих показаний датчиков (температура, влажность воздуха и почвы) в реальном времени с графиками изменений.

2. **Анализ растений** - фотографирование растения и анализ его состояния:
   - Определение цветовых характеристик (здоровый зеленый, желтый, коричневый)
   - Выявление возможных заболеваний и вредителей
   - Генерация рекомендаций по уходу

3. **Настройки** - конфигурация системы:
   - Выбор COM-порта для Arduino
   - Настройка камеры
   - Настройка расписания фотографирования
   - Синхронизация времени с Arduino

4. **Журнал** - отображение системных сообщений и истории событий

#### Ключевые компоненты кода:

- `ArduinoReader` - класс для чтения данных с Arduino через последовательный порт
- `PlantPhotoThread` - класс для фотографирования и анализа растений
- `GraphWidget` - класс для отображения графиков
- `MainWindow` - основное окно приложения
- `SetupDialog` - диалог настройки параметров системы

### Параметры, сохраняемые в конфигурации:

- Номер COM-порта
- Индекс камеры
- Интервал опроса датчиков
- Режим фотографирования (раз в день, два раза в день, каждые 10 минут)
- Время фотографирования

## Программа для Arduino

### Файл `temp_humidity_light_2.ino`

Скетч для Arduino управляет датчиками и исполнительными устройствами (реле).

#### Основные функции:

1. **Сбор данных с датчиков**:
   - Температура и влажность воздуха (DHT22)
   - Влажность почвы (датчик влажности почвы)

2. **Управление устройствами**:
   - Лампа освещения (через реле)
   - Шторы/жалюзи (через реле)
   - Насос для полива (через реле)
   - Вентилятор (через реле)

3. **Отображение информации**:
   - Вывод данных на LCD дисплей
   - Отправка данных в сериальный порт

4. **Автоматизация**:
   - Включение/выключение лампы по расписанию
   - Открытие/закрытие штор по расписанию
   - Включение полива при снижении влажности почвы
   - Включение вентилятора при повышении температуры

#### Режимы работы:

1. **Режим настройки (SETUP)**:
   - Установка целевой температуры и допустимого отклонения
   - Установка целевой влажности почвы и допустимого отклонения
   - Настройка времени открытия и закрытия штор
   - Настройка времени включения и выключения лампы

2. **Режим нормальной работы (NORMAL_OPERATION)**:
   - Отображение текущих показаний датчиков
   - Автоматическое управление устройствами
   - Переключение между режимами отображения

#### Поддерживаемые команды через сериальный порт:

- `TIME:YYYY-MM-DD HH:MM:SS` - установка времени
- `SET:TEMP:XX` - установка целевой температуры
- `SET:TEMP_TOL:XX` - установка допуска температуры
- `SET:SOIL:XX` - установка целевой влажности почвы
- `SET:SOIL_TOL:XX` - установка допуска влажности почвы
- `SET:CURT_OPEN:HH:MM` - установка времени открытия штор
- `SET:CURT_CLOSE:HH:MM` - установка времени закрытия штор
- `SET:LAMP_ON:HH:MM` - установка времени включения лампы
- `SET:LAMP_OFF:HH:MM` - установка времени выключения лампы

## Подключение и настройка

### Настройка аппаратной части:

1. Подключите датчики к Arduino согласно схеме:
   - DHT22 -> пин 13
   - Датчик влажности почвы -> аналоговый пин A0
   - Потенциометр -> аналоговый пин A1
   - Кнопка -> пин 12
   - Реле для лампы -> пин 5
   - Реле для штор -> пин 4
   - Реле для насоса -> пин 3
   - Реле для вентилятора -> пин 2
   - LCD дисплей -> пины 6, 7, 8, 9, 10, 11

2. Загрузите скетч `temp_humidity_light_2.ino` на Arduino.

3. Подключите Arduino к компьютеру через USB.

### Настройка программного обеспечения:

1. Запустите `FitoDomikLo.py` или `FitoDomikLo.exe`.

2. Перейдите на вкладку "Настройки":
   - Выберите COM-порт, к которому подключен Arduino
   - Проверьте и настройте камеру
   - Настройте режим фотографирования

3. Нажмите "Подключиться к Arduino".

4. При первом подключении запустится мастер настройки:
   - Установите целевую температуру
   - Установите допустимое отклонение температуры
   - Установите целевую влажность почвы
   - Установите допустимое отклонение влажности почвы
   - Настройте время открытия и закрытия штор
   - Настройте время включения и выключения лампы

## Работа с системой

### Мониторинг:

- Вкладка "Мониторинг" отображает текущие показания датчиков с графиками
- Данные обновляются в реальном времени
- Графики показывают историю изменений значений

### Фотографирование и анализ растений:

1. Перейдите на вкладку "Анализ растений"
2. Нажмите кнопку "СДЕЛАТЬ ФОТО РАСТЕНИЯ"
3. Система сделает фото с камеры и проанализирует состояние растения
4. Результаты анализа будут отображены в разделе "Результаты анализа"
5. Фотографии сохраняются локально в папке `~/FitoDomik_photos`

### Автоматическая работа:

- Система автоматически управляет устройствами в соответствии с настройками
- Лампа и шторы работают по расписанию
- Насос включается при снижении влажности почвы ниже установленного значения
- Вентилятор включается при повышении температуры выше установленного значения
- Фотографирование выполняется согласно выбранному расписанию

### Журнал:

- Вкладка "Журнал" отображает историю работы системы
- Сообщения содержат отметки времени и информацию о событиях
- Журнал помогает отслеживать работу системы и диагностировать проблемы

---

Система ФитоДомик позволяет автоматизировать уход за растениями и обеспечить оптимальные условия для их роста и развития. Комбинация программного и аппаратного обеспечения создает гибкую и настраиваемую систему для мониторинга и управления условиями выращивания. 
